<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hybrid Strength Planner</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="nav">
      <div class="brand"><span class="dot"></span> Hybrid Strength Planner</div>
      <nav class="tabs">
        <a id="navSetup" class="tab active">Setup</a>
        <a id="navPlan" class="tab">Plan</a>
        <a id="navLog" class="tab">Log</a>
      </nav>
      <div class="spacer"></div>
      <div class="controls">
        <button id="btnTheme" class="btn ghost" title="Toggle theme">Theme</button>
        <button id="btnExport" class="btn ghost" title="Export data">Export</button>
        <button id="btnImport" class="btn ghost" title="Import data">Import</button>
        <input id="importFile" type="file" accept="application/json" style="display:none" />
      </div>
    </div>
  </header>

  <main class="container">
    <section id="setup" class="grid grid-2">
      <div class="card">
        <h2>Profile & Settings</h2>
        <div class="row">
          <div>
            <label>Leg Press 1RM</label>
            <input type="number" id="legPress1rm" min="0" step="0.5" placeholder="e.g. 180" inputmode="decimal" />
          </div>
          <div>
            <label>Chest Press 1RM</label>
            <input type="number" id="chestPress1rm" min="0" step="0.5" placeholder="e.g. 100" inputmode="decimal" />
          </div>
        </div>
        <div class="row">
          <div>
            <label>Units</label>
            <select id="units">
              <option value="kg">Kilograms (kg)</option>
              <option value="lb">Pounds (lb)</option>
            </select>
          </div>
          <div>
            <label>Equipment Mode</label>
            <select id="mode">
              <option value="barbell">Barbell/Rack</option>
              <option value="machine">Machines/Bodyweight</option>
            </select>
          </div>
        </div>
        <div class="hint">Training max is automatically set to 90% of your 1RM for %‑based prescriptions.</div>
        <div style="margin-top:12px; display:flex; gap:8px;">
          <button id="saveSettings" class="btn primary">Save Settings</button>
          <span id="setupStatus" class="hint"></span>
        </div>

  <details id="availableEquipmentDetails" style="margin-top:12px;">
          <summary>
            <span class="summary-title">Available Equipment</span>
            <span class="summary-sub">Select what you have access to; plan adapts automatically</span>
          </summary>
          <div class="details-inner">
            <div id="equipmentList" class="grid grid-3"></div>
            <div style="display:flex; gap:8px; margin-top:10px;">
              <button id="equipSelectAll" class="btn ghost" type="button">Select all</button>
              <button id="equipClearAll" class="btn ghost" type="button">Clear</button>
            </div>
          </div>
        </details>
      </div>

      <div class="card">
        <h2>Program</h2>
        <details id="customProgramDetails">
          <summary>
            <span class="summary-title">Custom Program (JSON)</span>
            <span class="summary-sub">Paste your weekly plan to override the default</span>
          </summary>
          <div class="details-inner">
            <p class="hint">Format: an array of days (4 recommended). Each day has a name and exercises. Exercise fields: name, sets, reps, percent (0-1), primary ('leg'|'chest'|null). Example below.</p>
            <textarea id="customProgramJson" placeholder='[
  { "name": "Day 1 – Lower Body", "exercises": [
    { "name": "Back Squat (Barbell)", "key": "K_LOWER_PRIMARY", "sets": 5, "reps": 5, "percent": 0.85, "primary": "leg" },
    { "name": "Bulgarian Split Squat", "key": "K_LOWER_UNILATERAL", "sets": 3, "reps": 8, "percent": 0.75, "primary": "leg" }
  ]},
  { "name": "Day 2 – Upper Push & Pull", "exercises": [
    { "name": "Bench Press", "key": "K_UPPER_PRESS", "sets": 5, "reps": 5, "percent": 0.85, "primary": "chest" }
  ]}
]'></textarea>
            <div style="display:flex; gap:8px; margin-top:8px; justify-content:flex-end; flex-wrap:wrap;">
              <button id="btnSaveCustomProgram" class="btn">Save Custom Program</button>
              <button id="btnClearCustomProgram" class="btn ghost">Reset to Default</button>
            </div>
            <div class="hint" id="customProgramStatus"></div>
          </div>
        </details>
      </div>

      <div class="card" id="toolsCard">
        <h2>Tools</h2>
        <details id="tools1rm">
          <summary>
            <span class="summary-title">1RM Calculator</span>
            <span class="summary-sub">Estimate one-rep max from reps × weight</span>
          </summary>
          <div class="details-inner">
            <div class="row">
              <div>
                <label>Reps</label>
                <input type="number" id="calcReps" min="1" max="12" value="5" />
              </div>
              <div>
                <label>Weight</label>
                <input type="number" id="calcWeight" min="0" step="0.5" value="100" inputmode="decimal" />
              </div>
            </div>
            <div class="row" style="margin-top:8px; align-items:end;">
              <div class="hint">Formulas: Epley, Brzycki</div>
              <div style="text-align:right"><button id="btnCalc1RM" class="btn">Estimate</button></div>
            </div>
            <div id="calc1RMResult" class="hint" style="margin-top:8px"></div>
          </div>
        </details>

  <details id="toolsPlates">
          <summary>
            <span class="summary-title">Plate Calculator</span>
            <span class="summary-sub">Get plate pairs per side for a target load</span>
          </summary>
          <div class="details-inner">
            <div class="row">
              <div>
                <label>Target Load</label>
                <input type="number" id="plateTarget" min="0" step="0.5" value="100" inputmode="decimal" />
              </div>
              <div>
                <label>Bar Weight</label>
                <input type="number" id="barWeight" min="0" step="0.5" value="20" inputmode="decimal" />
              </div>
            </div>
            <div class="row" style="margin-top:8px">
              <div>
                <label>Available Plates (comma‑sep)</label>
                <input type="text" id="availablePlates" value="25,20,15,10,5,2.5" />
              </div>
              <div style="display:flex; align-items:flex-end; justify-content:flex-end;">
                <button id="btnCalcPlates" class="btn">Calculate</button>
              </div>
            </div>
            <div id="plateResult" class="hint" style="margin-top:8px"></div>
          </div>
        </details>

  <details id="toolsTimer">
          <summary>
            <span class="summary-title">Rest Timer</span>
            <span class="summary-sub">Simple between‑sets timer</span>
          </summary>
          <div class="details-inner">
            <div class="timer">
              <input type="number" id="timerMinutes" min="0" value="1" style="width:90px" inputmode="numeric" />
              <span class="timer-display" id="timerDisplay">00:00</span>
              <button id="btnTimerStart" class="btn">Start</button>
              <button id="btnTimerStop" class="btn ghost">Stop</button>
              <button id="btnTimerReset" class="btn ghost">Reset</button>
            </div>
            <div style="display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;">
              <button class="btn ghost preset-timer" data-seconds="30">30s</button>
              <button class="btn ghost preset-timer" data-seconds="60">1m</button>
              <button class="btn ghost preset-timer" data-seconds="90">1:30</button>
              <button class="btn ghost preset-timer" data-seconds="120">2m</button>
            </div>
          </div>
        </details>
      </div>
    </section>

    <section id="plan" class="hidden">
      <div class="card">
        <h2>12‑Week Plan <span class="tag">Auto‑generated</span></h2>
        <p class="muted">This plan adapts to your equipment and training max values. Percentages show loads or RIR cues.</p>
        <div class="row" style="align-items:end; margin-bottom:8px;">
          <div>
            <label for="weekRange">Week range</label>
            <select id="weekRange">
              <option value="all">All (1–12)</option>
              <option value="1-4">Weeks 1–4</option>
              <option value="5-8">Weeks 5–8</option>
              <option value="9-12">Weeks 9–12</option>
            </select>
          </div>
          <div style="text-align:right">
            <button id="btnExpandWeeks" class="btn">Expand all</button>
            <button id="btnCollapseWeeks" class="btn ghost">Collapse all</button>
          </div>
        </div>
  <div class="table-scroll" id="planContent"></div>
      </div>
    </section>

    <section id="log" class="hidden">
      <div class="grid grid-3">
        <div class="card">
          <h2>Analytics</h2>
          <div class="row" style="gap:16px; flex-wrap:wrap;">
            <div class="card" style="flex:1; min-width:200px;">
              <div class="muted">Days Trained</div>
              <div class="stat-value" id="statDays" style="font-size:28px; font-weight:700;">0</div>
            </div>
            <div class="card" style="flex:1; min-width:200px;">
              <div class="muted">Total Volume</div>
              <div class="stat-value" style="font-size:28px; font-weight:700;"><span id="statVolume">0</span> kg</div>
            </div>
            <div class="card" style="flex:1; min-width:200px;">
              <div class="muted">Avg / Session</div>
              <div class="stat-value" style="font-size:28px; font-weight:700;"><span id="statAvg">0</span> kg</div>
            </div>
          </div>
        </div>
        <div class="card">
          <h2>Sessions per Week</h2>
          <canvas id="progressChart" width="600" height="300" aria-label="Sessions chart" role="img"></canvas>
          <div class="hint">Weekly count of saved sessions.</div>
        </div>
        <div class="card">
          <h2>Volume per Week</h2>
          <canvas id="volumeChart" width="600" height="300" aria-label="Volume chart" role="img"></canvas>
          <div class="hint">Estimated kg lifted (primary lifts only).</div>
        </div>
      </div>
    </section>
    
    <section id="session" class="hidden">
      <div class="card">
        <h2 id="sessionTitle">Session</h2>
        <div class="muted" id="sessionSubtitle"></div>
        <div class="row" style="align-items:end; margin:10px 0;">
          <div>
            <label>Session Timer (min)</label>
            <div class="timer">
              <input type="number" id="sessionTimerMinutes" min="0" value="1" style="width:90px" inputmode="numeric" />
              <span class="timer-display" id="sessionTimerDisplay">00:00</span>
              <button id="sessionTimerStart" class="btn">Start</button>
              <button id="sessionTimerStop" class="btn ghost">Stop</button>
              <button id="sessionTimerReset" class="btn ghost">Reset</button>
            </div>
            <div style="display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;">
              <button class="btn ghost session-preset" data-seconds="300">5m</button>
              <button class="btn ghost session-preset" data-seconds="600">10m</button>
              <button class="btn ghost session-preset" data-seconds="90">1:30</button>
              <button class="btn ghost session-preset" data-seconds="120">2m</button>
            </div>
          </div>
          <div style="text-align:right">
            <button id="sessionBack" class="btn ghost">Back to Plan</button>
            <button id="sessionSaveEnd" class="btn primary">End Session & Save</button>
          </div>
        </div>

        <details open>
          <summary><span class="summary-title">Warmup</span> <span class="summary-sub">Dynamic prep</span></summary>
          <div class="details-inner" id="sessionWarmup"></div>
        </details>

        <details open>
          <summary><span class="summary-title">Exercises</span> <span class="summary-sub">Today’s work</span></summary>
          <div class="details-inner">
            <div class="table-scroll"><table id="sessionExercisesTable"></table></div>
          </div>
        </details>

        <details open>
          <summary><span class="summary-title">Recovery</span> <span class="summary-sub">Stretching & massage gun</span></summary>
          <div class="details-inner" id="sessionRecovery"></div>
        </details>

        <details>
          <summary><span class="summary-title">Notes</span> <span class="summary-sub">How did it go?</span></summary>
          <div class="details-inner">
            <div class="row">
              <div>
                <label>RPE</label>
                <select id="sessionRpe"><option value="">RPE</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option></select>
              </div>
              <div></div>
            </div>
            <textarea id="sessionNotes" placeholder="Notes, weights used, anything to remember..."></textarea>
          </div>
        </details>
      </div>
    </section>
  </main>

  <div id="modal" class="modal-backdrop" aria-hidden="true">
    <div class="modal">
      <button class="close-x" id="modalClose" aria-label="Close">×</button>
      <h3 id="modalTitle">Modal</h3>
      <div id="modalBody">...</div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>